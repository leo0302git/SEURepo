`timescale 1ns / 1ps
//////////////////////////////////////////////////////////////////////////////////
// Company: 
// Engineer: 
// 
// Create Date: 2025/02/26 09:48:17
// Design Name: 
// Module Name: tb_Printer
// Project Name: 
// Target Devices: 
// Tool Versions: 
// Description: 
// 
// Dependencies: 
// 
// Revision:
// Revision 0.01 - File Created
// Additional Comments:
// 
//////////////////////////////////////////////////////////////////////////////////


module Printer_tb;
    reg clk, rst_n, TR;
    reg [7:0] PD;
    wire RDY;
    parameter PERIOD = 20;      //????20ns????????50MHz????????printer
    parameter print_time = 10; //???10?????
    Printer #(
        .cnt_5ms(print_time))   //????????????????????????100period
    uut 
    (
        .clk(clk),
        .rst_n(rst_n),
        .TR(TR),
        .PD(PD),
        .RDY(RDY)
    );
    
    initial begin
        clk = 0;
        forever #(PERIOD/2) clk = ~clk;
    end
    
    initial begin
        #(PERIOD/2)
        rst_n = 0;
        TR = 0;
        PD = 0;
        #(PERIOD*2);
        rst_n = 1;
        #(PERIOD*2);

        //????????
        PD = 8'h61; // 'a'
        print_letter;
        PD = 8'h62; // 'b'
        print_letter;

        //????????
        #(10*PERIOD)
        rst_n = 0;
        TR = 0;
        PD = 0;
        #(PERIOD*2);
        rst_n = 1;
        #(PERIOD*2);

        //??????
        PD = 8'h63; // 'c'
        print_letter;
        $finish;
    end

    task print_letter;
    begin
        // ??????????????
        TR = 1;
        #(PERIOD*3);
        // ?????????????RDY????
        if (RDY == 0) begin
            $display("Time = %t,?????????RDY=0",$time);
            TR = 0;
        end
        else begin
            $display("Time = %t,??????????RDY=0",$time);
            $finish;
        end
        // ??????
        #(print_time*PERIOD+PERIOD*5);
        // ????????????????RDY = 1
        if (RDY == 1) begin
            $display("Time = %t,?????????????RDY=1",$time);
        end
        else begin
            $display("Time = %t,??????????????????RDY=1",$time);
            $finish;
        end
    end
    endtask
endmodule
/*
?tb??ï¿????
1. ??if???????????????????????????????????????????????RDY?ï¿½ï¿½?????100ns?????????????????????1????????????100ns????????????10ns?????????????
2. ?????????????????????????????ï¿½ï¿½???ï¿????ï¿½ï¿½??????????????rst_n=0???RDY??0?????????????0????????0??????RDY?????1????????????rst_n=0???????????RDY????
3. ?????+?????????????????????????????????????????
*/

/*
??????????
1.rst_n???????????
2.TR????PD????????
3.Printer????????????RDY????????????????PD????
4.TR?????????????TR????
5.?????????print_flag????
6.RDY???????????????????????????
7.TR=1????????????????
8.???????????????
9.????rst_n???????ï¿?????
10.????????????????????????????
11.TR=1??????????3?????
12.????????????????????RDY???????????????????????
*/
