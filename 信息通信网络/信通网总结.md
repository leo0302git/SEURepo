# 信息通信网络整理笔记

## 第一章 通信网络与服务

### 网络结构与服务的演进

通信网：提供不同位置用户间信息传递的一系列设备与装置

通信网的组成：

- 接入：连接用户终端设备与本地交换机之间的部分
- 交换：电路交换，分组交换，全光交换，软交换
- 传输

#### 电报网与报文交换

存储转发机制

① 消息达到电报站 ② 电报员存储消息直到目标通信线路可用 ③ 电报员将消息转发给下一个电报站

#### 电话网与电路交换

用户数为N时，专用电话网络需要(N-1)N/2,即N^2数量级的连接；而电路交换电话网络，只需要N个连接。

电路交换是面向连接的服务，信息传递之前需要先建立连接

电路交换的三阶段

1. 建立连接
2. 信息传输
3. 连接释放

#### 计算机网与分组交换

早期通过调制解调器走电话网络，以时分方式接入主机

计算机网络：阿帕网出现，路由提供无连接服务

因特网

**协议**：协议即约定两个或者多个通信实体之间信息交互的准则

IP协议：不能处理分组丢失，数据损坏和分组失序的问题

各子网络需要包含特定的分组交换机与网关路由器，并通过 网关与因特网的其他子网络进行通信

IP协议之上，有两种传输层协议（所有因特网应用都基于TCP 或 UDP）

UDP：使能信息块尽最大努力交付传输

TCP：使能字节流的可靠传输

### 通信网络发展的关键因素

技术、法规、市场、标准

## 第二章 计算机网络的层次化体系结构

### 2.1 OSI参考模型 

#### 2.1.1 七层模型 

![image-20241229145910966](C:\Users\Leo\AppData\Roaming\Typora\typora-user-images\image-20241229145910966.png)

**物理层**：任务是在一条链路（信道）上透明地传输比特流

常见的物理层技术：Ethernet, DSL,  modems

**数据链路层**： 在直接相连的链路上，传输以帧(frames)为单位的数据

引入了编址的问题: 称为物理层地址，或者MAC地址

数据链路层常见功能

•差错控制: 发现差错;  解决差错 

•媒体接入控制: 

•流量控制 Flow control: 如果信息传输速率超过 了接收者的处理速率… 

•连接管理: 链路激活、维护，释放等操作

> [!NOTE]
>
> “物理层地址”不是物理层概念而是数据链路层概念

**网络层**的任务是在不同的链路上转发分组，主要功能是路由和转发

• 编址 

• 建立路由表：选择到目标节点最佳的下一跳节点 

• 根据路由表，将分组转发给对应的下一跳节点 

• 可能涉及到分片和重组 

• 拥塞控制Congestion control 

• 网络层的连接管理（when connection-based）

**传输层**：负责在终端的两个进程间传输数据。一般分为可靠传输（面向连接的）和不可靠的传输（面向无连接的）

“传输层负责端系统上不同进程间的消息传递. 而网络层负责传递到正确的端系统上”

主要功能

- 基于端口的寻址
- 流量控制和差错控制（与数据链路层还不一样）

**会话层**：数据的交换方式(如 半双工half-duplex, 全双工full duplex 等）, 数据同步控制点等等

**表示层**：数据的表示问题, 通常解决的是机器相关的表达与机器无关的表达之间的转换

**应用层**：提供应用层所需的服务. 如WWW业务, 浏览器使用HTTP应用层协 议获取文档

最顶端三层常常合并为应用层一层

#### 2.1.2 层，协议，及服务 

SAP: service access point, 服务访问点，通常是一个软件或硬件接口 

SDU: service data unit，业务数据单元 

Layer n entities: n层实体 

PDU: protocol data unit 协议数据单元，各层与对等层交换的数据单元

封装:  n+1’s PDU = n’s SDU        n’s PDU = n’sPCI+n’s SDU

高层的PDU成为低层的SDU

IDU: Interface Data Unit 接口数据单元，指相邻层经 过SAP点的数据

ICI: Interface Control Information 接口控制信息，指 IDU中的控制信息部分

PCI : Protocol Control Information 协议控制信息， PDU中的控制信息部分，体现了协议的控制消息

协议分层后的数据关系

![image-20241229151010575](C:\Users\Leo\AppData\Roaming\Typora\typora-user-images\image-20241229151010575.png)

服务类型分类

无连接的（如UDP，IP）

- 直接进行SDU的传输
- 没有连接建立、维护、拆链的过程
- 服务的典型特征：无序、尽最大努力服务 (Best-effort)
- 提供确认的或非确认的服务

面向连接的（如TCP，ATM）

- 连接建立的三个阶段： 1.待建立连接的SAP之间启动连接，并初始化连接状态 2.传输SDU 3.拆除连接
- 服务的典型特征：有序、可靠
- 提供确认的（confirmed）服务

**分片和重组**

当高层的数据量太大时，发送时将之拆为若干个**分片**，接收时**重组**恢复会原始大小

**组块与分块(Blocking and Unblocking)**

发送时，将多个高层 PDU（即本层SDU）组合为一个数据块整体发送； 接收时，将该数据块恢复为原始的若干小数据块

**复用与解复用Multiplexing & Demultiplexing**

多个高层协议可以共用同一个低层的服务.解复用时通过解复用键值来区分高层协议

**分裂/整合 Splitting/Recombining**

若干个低层同时为一个高层提供服务

**OSI小结**

协议是水平的，对等层都认为自己在直接与对方通信

服务是垂直的

![image-20241229151900734](C:\Users\Leo\AppData\Roaming\Typora\typora-user-images\image-20241229151900734.png)

![image-20241229151910855](C:\Users\Leo\AppData\Roaming\Typora\typora-user-images\image-20241229151910855.png)

有时用数据包统称三层及以上的数据

### 2.2 TCP/IP参考模型 

#### 2.2.1 TCP/IP 协议栈结构 

![image-20241229152050236](C:\Users\Leo\AppData\Roaming\Typora\typora-user-images\image-20241229152050236.png)

套接字

套接字是应用程序与协议栈交互的手段，协 议栈提供一系列函数调用（SAP点）。创建套接字时， 会关联本地IP地址、协议类型（TCP/UDP），端口号。 套接字与创建它的进程（程序） 关联。

例如，源套接字: (TCP, (B.2), C)    //TCP是协议类型，C表示 某端口 ；目的套接字: (TCP, (A.1), 80) 两者的组合: (TCP, (B.2), C, (A.1), 80) ，又称五元组

### 2.3 ATM体系结构

![image-20241229152442978](C:\Users\Leo\AppData\Roaming\Typora\typora-user-images\image-20241229152442978.png)

## 第3章  交换技术基础

![image-20241229152753961](C:\Users\Leo\AppData\Roaming\Typora\typora-user-images\image-20241229152753961.png)

### 3.1  电路交换 

- 专用的资源：无共享 
- 类似于电路（有保证的）性能 
- 需要呼叫建立
- 网络资源（如带宽）分割为片，分配给呼叫，不用时就处于空闲，因为不共享

时延分析

![image-20241229153020963](C:\Users\Leo\AppData\Roaming\Typora\typora-user-images\image-20241229153020963.png)

电路交换网时延计算例题p13

### 3.2  报文交换 

- 每个端到端数据流采用报文传输  
- 用户A、B的报文共享网络资源 
- 每个报文使用全部链路带宽 
- 按需使用资源，存在资源竞争，如报文排队

### 3.3  分组交换 

- 每个端-端数据流划分为分组
- 用户A、B的分组共享网络资源 
- 每个分组使用全部链路带宽 
- 按需使用资源 

报文交换和分组交换都使用了存储转发机制。采用存储转发方式的分组交换兼有电路交换和报文交换的优点，它与报文交换的不同在于：分组交换将用户要传送的信息分割为若干个分组（packet ）， 每个分组中有一个分组头，含有可供选路的信息和其他控制信息。

分组交换的延时

- 节点处理延时：校验比特错误，确定输出链路
- 排队延时：在输出链路中等待传输的时间
- 传输延时：发送比特到链路上的用时
- 传播延时：距离/速度

分组交换的两种不同形式的服务：虚电路(cirtual circuit)和数据报(datagram)

#### 虚电路

发送第一个数据包之前，先要等待一个完整的RTT用于建立连接，预约资源

![image-20241229154148589](C:\Users\Leo\AppData\Roaming\Typora\typora-user-images\image-20241229154148589.png)

#### 数据报

无等待连接建立的RTT延时；主机一旦准备好，就可以发送数据。无连接，不可靠

![image-20241229154243141](C:\Users\Leo\AppData\Roaming\Typora\typora-user-images\image-20241229154243141.png)

三种交换机制的延时比较

![image-20241229154422828](C:\Users\Leo\AppData\Roaming\Typora\typora-user-images\image-20241229154422828.png)

### 3.4  网络中时序

电路交换时序

![image-20241229154609743](C:\Users\Leo\AppData\Roaming\Typora\typora-user-images\image-20241229154609743.png)

数据报型分组交换延时

![image-20241229154859452](C:\Users\Leo\AppData\Roaming\Typora\typora-user-images\image-20241229154859452.png)

虚电路型分组交换延时

![image-20241229155017307](C:\Users\Leo\AppData\Roaming\Typora\typora-user-images\image-20241229155017307.png)

可以看到就比数据报型分组交换多了三个ML（三个单程传播总延时）和三个单程处理总延时(M-1)P

> [!NOTE]
>
> 我们通常只对如下延时感兴趣，即从发送方发送第一个比特的时刻 开始，到接收方接收最后一个比特的时刻结束（我们排除了连接结束 的应答时间）。如果是这种情况，前面的计算式中，系数"4"都改为"3"

结论：

- 随着传输速度的进步，总延时由传播延时占主导，这是光 速限制的结果。
- 当链路速度慢时，瓶颈是链路的传输速度。消除存储、转发对降低 时延有帮助，额外的（建立、拆除连接）往返延时可忽略。因此，使用电路交换技术降低了网络总延时。
- 当链路速度快时，瓶颈是传播延时。附加往返延时的影响大，消除存储、转发的延时可忽略。因此，使用电路交换技术增加了网络总延时。

## 第四章 数据传输基础

### 4.1 信息的数字表示 

假设模拟信号带宽为W，最小采样速率为2W。量化比特数n越多，量化精度越高，传输所需速率越高。如电话语音W=4kHz,采样频率为8kHz，8bit量化，则传输速率为8*8k=64kbps

### 4.2 数字通信 

设信道带宽W，不考虑符号间干扰，则最大脉冲频率：
低通信道：2W pulses/s
带通信道：W pulses/s

低通信道对于多级脉冲传输，如果幅度级M=2^m，则比特率为2mW bps
带通信道减半即可

### 4.3 线路编码 

考虑因素

- 需要避免低频分量
- 发送功率尽量小
- 定时问题：信号跃变有助于定时
- 带宽效率：跃变越多，带宽需求越多
- 实现起来的复杂性
- 差错检测能力

![image-20241229161607122](C:\Users\Leo\AppData\Roaming\Typora\typora-user-images\image-20241229161607122.png)

各自缺点：NRZ低频多、Bipolar拥挤在T/2，Manchester带宽浪费严重

#### 单极性不归零编码NRZ

- 平均功率高$\frac12 A^2 + \frac12 0 = \frac 12 A^2$
- 长 A or 0：定时性能差，且有低频分量 
- Simple

#### 双极性不归零编码polar NRZ

- 平均功率低$\frac12 (0.5A)^2 + \frac12 (-0.5A)^2 = \frac 14 A^2$
- 长 +A/2 或 –A/2 :定时性能差，且有低频分量 
- Simple

#### 双极性编码Bipolar Code

- 有{A,0,A}三个信号等级，“1”交替映射到 +A or –A ，“0”映射为0电平
- 低频分量少
- 连续的1序列编码为方波，频谱集中在T/2
- 长0时容易失去同步

#### 曼彻斯特码和mBnB码

- 映射关系：首T/2“1” -> A/2 , 后 T/2 -A/2；首T/2 “0” -> -A/2 , 后 T/2 A/2  
- 每个比特都在中间有个跃变：定时性能好；带宽*2 
- 易于实现

mBnB码就是将$2^m$个数映射到n个比特上的编码方式。Manchester是1B2B码

#### 差分编码 Differential Coding

- 极性反转 +A 变成 –A 或相反 
- 对于极性反转错误，差分线路编码提供了鲁棒性 
- “1” 映射成跃变 ,“0” 保持不变 
- 带宽性能不变 
- 差错成对出现
- 既可以用于NRZ也可以用于Manchester

### 4.4 调制解调  

ASK，FSK，PSK，略。

### 4.5 传输媒介

基本问题：信息承载能力（幅度、带宽和抗干扰性）和信号传播速度

#### 衰减效应

有线媒体具有指数依赖性，衰减 Attenuation in dB = kd

无线媒体具有对数依赖性，Attenuation in dB = n log d

## 第五章 对等协议和数据链路层

数据链路层的功能

- 成帧、访问控制
- **相邻节点间**的可靠传输
- 差错检测、纠正和控制（确认，定时器与序号）
- 流量控制
- 半双工和全双工

### 5.1 检错与纠错 

系统预先规定一些传输模式，所有传输数据块符合某种特定的模式。如果接收到的数据块不符合该模式，则判定出错。

所有的纠错与检错方法都基于冗余。设想如果没有冗余，每一种比特组合都是合法模式，那就没法知道某一个接受到的模式是本来就这样还是由其他模式出错导致的。

差错控制编码分为纠错编码和检错编码。重传有ARQ : Automatic Repeat Request和FEC : Forward Error Correction

#### 如何评价码的好坏

汉明距离Hamming Distance --两个等长码组之间相应位取 值不同的数目

- 检测e个比特的错误，要求码的最小距离≥e+1

将一个3 bit码字一一地映射到一个3维空间，则所有可能的比特组合共有8种，对应8个点。如果要检测一个bit的错误，则设置的合法点之间的最短汉明距离应该为2.如果为1，那么至少有两个合法点之间距离为1，那么如果接收到这两种码字中的任何一种，都无法判断是本来发的就是这个还是由其他码字出错得到的。

- 纠正t个比特的错误，要求码的最小距离≥2t+1

沿用上面的例子，如果要纠正一个比特的错，则设置的合法点之间的最短汉明距离应该为3.如果为2，比如有两个合法点为(0,1,1)和(0,0,0)，那么当接收到(0,1,0)时，虽然知道肯定是由(0,1,1)或(0,0,0)错过来的，但没法知道是由哪个错过来的。而如果最近的两个合法点为(1,1,1)和(0,0,0)，接收到(0,1,0)，由于知道只错了1bit（这是基于1bit出错的题设的），所以可以纠正到(0,0,0)

- 纠正t个同时检测e(≥t)个随机错误，则要求码的最小距离 ≥t+e+1

#### 错误的类型

单比特错误

突发错误：突然出现一连串的比特错误。交织是一种抗突发性错误的有效手段，把信道上突发错误在时间上扩散开，转化为独立的随机错误，这样纠错码就可以应用于突发错误信道，充分发挥纠错码的作用。纠错码对抗随机错误，交织编码技术可以同时解决信道随机错误和突发错误。

#### 奇偶校验码

##### 一维奇偶校验码

在k比特信息位之后附加一个校验位以构成码字

开销：1/(k+1)

覆盖范围：50%（随机误差向量模型。 如： e=[0 0 0 0 0 0 0 0]和e=[1 1 1 1 1 1 1 1]出现的概率是相等的）

- 所有改变奇数个比特的错误都可以被检测出来 
- 所有偶数个比特的错误模式都无法被检测出来

随机误差比特模型：各比特间发生错误的概率相互独立，单比特错误概率为$p$

只发生一个bit出错的概率$P(w(e)=1) = (1-p)^{n-1} p$

发生2个bit出错的概率$P(w(e)=2) = P(w(e)=1) \frac{p}{1-p} <P(w(e)=1)$

发生k个bit出错的概率$P(w(e)=k) = P(w(e)=1) (\frac{p}{1-p})^{k-1} <P(w(e)=k-1)$

一维奇偶校验漏检的概率$(2bit出错的情况数)\times P(w(e)=2) + ... + (2kbit出错的情况数)\times P(w(e)=2k)+... , k =1,2,3,...$

其中j bit出错的情况数可表示为$C_j^n = \frac{n!}{j!(n-j)!}$​

##### 二维奇偶校验码

生成：

![image-20250103191459274](C:\Users\Leo\AppData\Roaming\Typora\typora-user-images\image-20250103191459274.png)

检查

![image-20250103191514611](C:\Users\Leo\AppData\Roaming\Typora\typora-user-images\image-20250103191514611.png)

- 检测所有1-，2-，3比特的和一些4-比特的错误
- 纠正所有1比特错误

##### 其他检错码

**Internet校验和**：在IP，TCP，UDP中使用的检错方式。无法检测失序字节，可以检测所有奇数个比特错误和绝大部分偶数个比特错误

发送方

- 将IP/TCP/UDP的包分成多个n比特的块
- 将其利用1的补码的方式相加，相加的结果保持n比特的长度
- 将结果取反，得到所需的校验和，随数据一起发送

接收方

- 将数据切分成k块n比特长度的数据块
- 将数据块通过1的补码的方式累加 
- 将和取反，若所得的和是0，数据被接受，否则拒绝

**循环冗余校验码**CRC（多项式编码）

利用移位寄存器实现。首先，将二进制向量映射为多项式，从零次项开始。多项式的加、乘、除与一般类似，但是加法是在模2意义下进行的。(x+x=0)竖式计算中没有减法也没有借位，都是加法，没有进位。

n比特的码字： n – 1阶多项式.所有的码字都满足以下模式
$$
b(x) = x^{n-k}i(x)+r(x)=q(x)g(x)+r(x)+r(x) = q(x)g(x)
$$
所有码字都是**生成多项式**g(x)的倍数.接收方需要除以g(x)，并检查余数是否为0。若余数非0，那么接收到的n维元组不是合法的码字

接收用除法电路

![image-20250103194503154](C:\Users\Leo\AppData\Roaming\Typora\typora-user-images\image-20250103194503154.png)

无法被检测到的错误模式：设加性错误多项式为$e(x)$如果$e(x)$可以被$g(x)$整除，则错误无法被检测到

### 5.2 ARQ协议和可靠数据通信

ARQ(Automatic Repeat Request) 目的：即使数据在传输过程中出错，ARQ协议的检错和重传机制也能够保证数据被正确传送到接收端

§5.2.1 停止等待协议：SWP ( Stop-and-Wait) 

帧头需要加入序号，$S_{last}$代表最近一次传输的帧的序号，$R_{next}$是接收方期待接收到的下一帧的序号，隐含了对所有前序帧的确认。对于发送方来说，序号正确的情况是R_next = S_last+1，因为发送方最近一次传输的帧号是S_last，对面若正确收到，给的是下一帧期望的序号；对于接收方来说，正确的情况是S_last=R_next，因为对接收方来说，这表明发送方收到了我对下一帧的期望并以此发来了我想要的帧。

理论上1bit的序号就已经足够，如果有两bit，可以刻画全局状态(S_last,R_next)

时序分析

![image-20250103195949093](C:\Users\Leo\AppData\Roaming\Typora\typora-user-images\image-20250103195949093.png)

有效的信息传送率,($n_o$: frame overhead)
$$
R_{eff}=\frac{n_f - n_o}{t_0}
$$
传输效率
$$
\eta_0 = \frac{R_{eff}}{R}=\frac{1-\frac{n_o}{n_f}}{1+\frac{n_a}{n_f}+\frac{2(t_{prop}+t_{proc})R}{n_f}}
$$
时延带宽积$2(t_{prop}+t_{proc})R$，它表征了（来回的）传输管道容纳信息的容量。时延带宽积越大，效率越低，常见于高速或长传播时延的信道中。

如果假设帧无差错传输的概率为1 – Pf，错误的帧要丢弃重传，那么平均传输时间变为$t_0/(1-P_f)$​，传输效率变为
$$
\eta_SW = \frac{R_{eff}}{R}=\frac{1-\frac{n_o}{n_f}}{1+\frac{n_a}{n_f}+\frac{2(t_{prop}+t_{proc})R}{n_f}}(1-P_f)
$$
假设一个比特出错的概率为p，由于帧中有$n_f$个比特，所以
$$
1-P_f = (1-p)^{n_f}\approx e^{-n_f p}
$$
当$n_f p$趋近于1时，差错率开始影响性能

§5.2.2 后退N帧协议：GBN ( Go Back N )  

§5.2.3 选择重传协议：SRP (Select Repeat Protocol)

###  5.3 滑动窗口流量控制

### 5.4 成帧 

### 5.5 高级数据链路控制（HDLC：High-Level Data Link Control） 

### 5.6 点对点协议